# Prompt History
- UTC: 2026-02-26T21:09:42Z
- LLM: GPT-5.2-Codex

## Prompt
The user was unsatisfied with the code that the agent previously produced, which can be found as the latest commit in the git history.

<PREVIOUS_PR_TITLE>
Preserve F22 crash momentum and add burning smoke
</PREVIOUS_PR_TITLE>

<PREVIOUS_PR_DESCRIPTION>
### Motivation
- Fix visual/physics regression where an airborne F22 dropped vertically on destruction instead of preserving forward momentum. 
- Enhance crash visuals so emitted smoke shows an obvious burning/flame glow during descent.

### Description
- Capture the jet's current speed when the crash sequence starts in `beginF22CrashSequence` and interpolate a forward-facing `crashSpeed` in `updateF22CrashState` so the F22 glides forward while descending (`src/game/movementF22.js`).
- Extend `emitSmokeParticles` to accept an options object with `fireIntensity` and store `fireIntensity` per particle while ensuring pool reset safety (`src/utils/smokeUtils.js`).
- Render a flame/glow overlay for smoke particles that carry `fireIntensity` in the smoke renderer so crash smoke visibly burns (`src/rendering/effectsRenderer.js`).
- Add a Playwright E2E regression test `tests/e2e/f22CrashMomentum.test.js` that spawns an airborne F22, forces destruction, and asserts crash-state entry, forward travel, positive horizontal crash velocity, burning-smoke emission, and final crashed state.
- Update project tracking artifacts and prompt-history to reflect the change (`TODO/Bugs.md`, `specs/021-f22-raptor-unit.md`, `specs/027-playwright-e2e-testing.md`, `prompt-history/2026-02-26T20-56-52Z_f22-crash-fire.md`).

### Testing
- Attempted to run the new E2E via `npm run test:e2e -- tests/e2e/f22CrashMomentum.test.js --project=chromium`, but Playwright Chromium was not available and `npx playwright install chromium` failed due to a CDN `403 Forbidden` in this environment (E2E run aborted).
- Ran repository lint flow `npm run lint:fix:changed` which completed successfully and then ran targeted ESLint on modified files (`npx eslint src/game/movementF22.js src/rendering/effectsRenderer.js src/utils/smokeUtils.js tests/e2e/f22CrashMomentum.test.js`) with no errors.
- Started the dev server and executed a short Playwright script to capture a runtime screenshot of the crash/fire visuals (artifact: `browser:/tmp/codex_browser_invocations/3d30efb2795a1d2d/artifacts/artifacts/f22-crash-fire.png`).
- Commit message for these changes: `Fix F22 crash momentum and add burning smoke effect`
</PREVIOUS_PR_DESCRIPTION>

<PREVIOUS_PR_DIFF_AND_COMMENTS>
diff --git a/TODO/Bugs.md b/TODO/Bugs.md
(File changed with 1 additions, 0 deletions)
diff --git a/None b/prompt-history/2026-02-26T20-56-52Z_f22-crash-fire.md
(File changed with 6 additions, 0 deletions)
diff --git a/specs/021-f22-raptor-unit.md b/specs/021-f22-raptor-unit.md
(File changed with 1 additions, 0 deletions)
diff --git a/specs/027-playwright-e2e-testing.md b/specs/027-playwright-e2e-testing.md
(File changed with 21 additions, 0 deletions)
diff --git a/src/game/movementF22.js b/src/game/movementF22.js
(File changed with 14 additions, 3 deletions)
diff --git a/src/rendering/effectsRenderer.js b/src/rendering/effectsRenderer.js
(File changed with 21 additions, 0 deletions)
diff --git a/src/utils/smokeUtils.js b/src/utils/smokeUtils.js
(File changed with 13 additions, 1 deletions)
diff --git a/None b/tests/e2e/f22CrashMomentum.test.js
(File changed with 136 additions, 0 deletions)
</PREVIOUS_PR_DIFF_AND_COMMENTS>

Please address any inline comments on the diff, as well as any additional instructions below.

the unit still when hit and destroyed does not continue to fly into heading direction with current speed while crash starts and proceeds (ensure it does). 
